<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>23Lab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="23Lab">
<meta property="og:url" content="http://blog.23lab.com/index.html">
<meta property="og:site_name" content="23Lab">
<meta property="og:locale" content="zh">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="23Lab">
  
    <link rel="alternative" href="/atom.xml" title="23Lab" type="application/atom+xml">
  
  
    <link rel="icon" href="http://blog.23lab.com/images/avatar.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://blog.23lab.com/images/avatar.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">EricHua23</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/erichua23" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/javoft" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/AndroidThings/" style="font-size: 10px;">AndroidThings</a> <a href="/tags/Angular/" style="font-size: 10px;">Angular</a> <a href="/tags/Code-Style/" style="font-size: 10px;">Code Style</a> <a href="/tags/Deploy/" style="font-size: 10px;">Deploy</a> <a href="/tags/Foosball/" style="font-size: 10px;">Foosball</a> <a href="/tags/IoT/" style="font-size: 10px;">IoT</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/NGINX/" style="font-size: 10px;">NGINX</a> <a href="/tags/Node/" style="font-size: 10px;">Node</a> <a href="/tags/Open-Source/" style="font-size: 10px;">Open Source</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/SDK/" style="font-size: 10px;">SDK</a> <a href="/tags/StandardJS/" style="font-size: 10px;">StandardJS</a> <a href="/tags/Swagger/" style="font-size: 10px;">Swagger</a> <a href="/tags/Unit-Test/" style="font-size: 10px;">Unit Test</a> <a href="/tags/Vim/" style="font-size: 10px;">Vim</a> <a href="/tags/Zend-Framework/" style="font-size: 10px;">Zend Framework</a> <a href="/tags/develop-api/" style="font-size: 10px;">develop, api</a> <a href="/tags/mock/" style="font-size: 10px;">mock</a> <a href="/tags/南京/" style="font-size: 20px;">南京</a> <a href="/tags/南京大学/" style="font-size: 10px;">南京大学</a> <a href="/tags/实习/" style="font-size: 10px;">实习</a> <a href="/tags/杭州/" style="font-size: 10px;">杭州</a> <a href="/tags/树莓派/" style="font-size: 10px;">树莓派</a> <a href="/tags/桌上足球/" style="font-size: 10px;">桌上足球</a> <a href="/tags/淘宝/" style="font-size: 10px;">淘宝</a> <a href="/tags/编辑器/" style="font-size: 10px;">编辑器</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.bihe0832.com">子勰的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.niceday.me">Nice Day</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">现在微众银行主要负责微众银行App开发, 工作范围在于React Native，Web前端，Android&amp;iOS开发, 同时对各种非工作范围的技术和工具也有浓烈的兴趣.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">EricHua23</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://blog.23lab.com/images/avatar.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">EricHua23</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/erichua23" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/javoft" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-default-value-for-interface-and-components" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/10/24/default-value-for-interface-and-components/" class="article-date">
  	<time datetime="2017-10-24T03:29:27.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/24/default-value-for-interface-and-components/">容易被忽视的不容忽视的默认值设计</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>提到默认值肯定很多人觉得这根本不值一提，非常简单，如果是这样那我觉得你可以继续往下阅读了。<br>默认值的设置应该是所有开发人员都会遇到的一个问题，首先我们想一下默认值是什么？为什么需要默认值？字面意思也比较容易理解到，就是你设计的接口或者组件，在别人不做特殊干涉的时候你的行为。很多开发可能已经形成了自己的模式，但是我相信很多开发人员没有形成，最近的工作中遇到几次默认值的问题，根据这些经验梳理了自己思考的默认值规则，希望与您一起探讨，也希望能让读者在思考如何设置默认值的时候少一些纠结，少一点随意而为，避免一些类似文中提到的错误。</p>
<h2 id="1-Don’t-make-me-think"><a href="#1-Don’t-make-me-think" class="headerlink" title="1. Don’t make me think"></a>1. Don’t make me think</h2><p>《Don’t make me think》是一本讲设计的书，非常推荐，我自己一直认为接口的设计也应该做到“Don’t make me think”</p>
<p>我们写任何一个接口或者组件，这个接口一定是给别人用或者自己用的，那要想让调用者用得舒服，首先，接口参数肯定是越少越好，你也不想去用一个有十几个参数说明的接口，对吧？但是这里会出现一个矛盾，易用性和扩展性的折中，接收的参数少，外部的控制能力下降，接口的扩展性降低。接收的参数多，接口非常难用，在确定你的接口好用之前，谁愿意去读你那长篇的文档呢。<br>这种情况下，默认值的设置就至关重要了，首先保证接口易用性，我们先要分析我们的接口哪些参数是80%（强行2 8原则）的场景会用到的，这些值直接强制要求传入，而剩下的20%的场景，可以用可选参数来提供外部定制的能力，如此保证了扩展性，既然是可选，那就涉及到了默认值，因为已经要求调用者传入了必填参数，这些可选参数的默认值应该是保证必填参数填了以后80%的场景下能正常运行的，因为只有这样，别人才可能有兴趣阅读你可选参数的文档，先用简单的接口吸引住使用者，让他对你的接口的第一印象是：简单易用，之后深入了解再让他知道你的接口不止简单易用，还很容易扩展，能力很丰富。接口的设计最好做到“一行代码运行”<br>想象一下为什么iMac用得爽，还有现在各种软件上的“一键清理”、“一键卸载”、“一键登录”，这不都是因为减少了用户的思考成本吗？</p>
<h2 id="2-兼容！兼容！还是兼容！！"><a href="#2-兼容！兼容！还是兼容！！" class="headerlink" title="2. 兼容！兼容！还是兼容！！"></a>2. 兼容！兼容！还是兼容！！</h2><p>前面一段提到了写新接口的时候的原则，最重要的是通过科学的设置默认值，保持扩展性的同时保证了易用性，那如果遇到老接口改造呢？带上了历史包袱，事情会变得不太一样。<br>新接口的设计，我们会重点关注这个接口的设计是否优雅，但是面对老接口的时候，我们不得不优先保证正确性，因为此接口可能已经被非常多地方用到，大的改动可能引入铺天盖地的bug。所以只能退而求其次，先正确再优雅。<br>为了扩展老接口能力，我们可以为接口新增参数，把某些以前没暴露的内部细节暴露出来，这种情况下的默认值设计，几乎没有选择，只能将参数的默认值设成以前内部写死的值，如此才可能保持内部行为不变，即使那个默认值看上去非常不优雅，像坨shi一样，还是必须得这样，因为先正确，再优雅。当然在这种改动的时候如果检查以后调用方不是特别多，可控可改，那最好的还是根据新的接口设计，重构调用方的代码，正确和优雅同时拿下，这是最理想的状态，不能完美的时候先保正确。</p>
<h2 id="3-不要让事情变更坏"><a href="#3-不要让事情变更坏" class="headerlink" title="3. 不要让事情变更坏"></a>3. 不要让事情变更坏</h2><p>以前的一个项目有个表单页面，下一步按钮为了更好的体验，在用户填写的内容不符合规则时，按钮不能点击，直到引导用户按规则输入了内容。听起来功能非常简单，人畜无害对吧，结果出现了一个线上的生产问题，为什么？ 因为判断规则的代码出错了，用了默认值，默认值是不能点。就因为这，发了紧急版本，WTF。</p>
<p>这里更多的可能不是接口设计，而是默认业务逻辑的设计，例如上面的场景，只要把默认值改成按钮可以点击，明确检测到不能点击了再限制，那虽然是bug，但是并不会变得这么紧急。所以我们需要思考，我们的业务代码是要做什么？在前端，很多体验优化的点，这些点默认值应该是更宽松（其实很多人是很随意的设计这些默认值的），最坏情况是这个优化点无效，不要因为体验优化的点影响业务流程，偷鸡不成蚀把米，业务流程的默认值设计也千万大意不得。然而我们也不是所有地方都应该宽松，特别是在后台系统涉及到安全方面的逻辑时，应该是要默认严格，有任何差错也不要去用默认值容错，例如密码校验的地方默认值是返回true，这样的产品你敢用？所以总结起来，主要两点，体验优化从宽，安全控制从严。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>敲黑板！！！  </p>
<ol>
<li>新接口必填参数能少则少，默认值保证80%场景正确</li>
<li>老接口改造，先保证正确，再考虑优雅</li>
<li>前端体验优化，默认值从宽，后段安全控制默认值从严。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/develop-api/">develop, api</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-why-should-you-write-a-open-source-library" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/06/27/why-should-you-write-a-open-source-library/" class="article-date">
  	<time datetime="2017-06-27T05:19:24.000Z" itemprop="datePublished">2017-06-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/27/why-should-you-write-a-open-source-library/">你为什么也应该写一个开源库？</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前工作折腾了一年多SDK，到现在公司也是先做SDK再做App，所以从SDK的角度来说，我被人“坑”过，也坑过别人，在这块思考得挺多，简单说说我的一些看法。首先很多人看到这个问题的时候，肯定都会觉得，写库是牛人干的事情，我之前也不例外的这样认为，但是最近开始尝试写了几个简单的NPM包，我发现上面的逻辑很可能反了，可能是写库让他们变牛或者变更牛。当然，如果你是Android开发，你的库可能是AAR，如果iOS那应该是framework，下文提到的“库”就作为各种公共可供第三方复用的独立模块的代称。</p>
<h2 id="0-写库逼迫你解耦和抽象"><a href="#0-写库逼迫你解耦和抽象" class="headerlink" title="0.  写库逼迫你解耦和抽象"></a>0.  写库逼迫你解耦和抽象</h2><p>我们在软件工程学习的过程中，就无数次的被强调软件模块的设计要高内聚低耦合，然而大多数情况这只是停留在说说的基础上，很多人的代码如果要抽离，是非常困难的，经常会有公共的工具库里面带有业务逻辑的情况，也就是这些代码无法直接拿出来做库供别人用的，即是说这份代码是高耦合的。<br>写业务逻辑的思路是，写一份代码来满足当前需求。写库的思路是，我要实现一个功能，它可以让某个业务需求的实现更简单，同时他具有<strong>通用性</strong>。通常情况我们是从业务代码里面提公用库，这个过程就是解耦和抽象的过程，目标就是让代码更通用，对外界依赖更少，职责更纯粹。这样的事做多了，我相信你自己的代码即使不抽成公共库，也能比以前耦合更低。<br>PS: 可以参考《重构 改善既有代码的设计》来学习如何提取和抽象公用的部分。</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Open-Source/">Open Source</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SDK/">SDK</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2017/06/27/why-should-you-write-a-open-source-library/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-how-to-setup-team-code-style" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/06/06/how-to-setup-team-code-style/" class="article-date">
  	<time datetime="2017-06-05T20:46:47.000Z" itemprop="datePublished">2017-06-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/06/how-to-setup-team-code-style/">创业团队如何制定可执行的代码规范</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>回想起来自己工作这么些年，也经历了不少团队，经历的项目更不算少了， 但是要说到代码规范， 问我我经历的这些代码规范是不是满意，我不得不如实回答：不是很满意。当然我自己的代码规范和风格也没有完全固化下来，近一年左右也开始关注到这个问题，为了让自己的代码风格能逐渐固化，我会专门用一个笔记来记录一些可能自己会纠结的写法，这样做了以后明显能感觉到自己代码风格的飘忽程度有所收敛。恰巧公司负责的项目也需要整理代码规范，正因如此我开始思考<strong>如何制定可执行的代码规范</strong>这个问题。<br>提到团队的代码规范，不止我经历过的，我和一些朋友也有聊过， 有微软那个级别的，也有BAT这种级别的，项目大的也有，小的亦很多。其中不乏规范的做的比较好的，有规范、有工具、还会有Code Review来保证。但是大公司规范和流程真的适合所有团队吗？我所看到的是大部分团队参照某某公司的规范和流程，定义了一个非常严格的标准，然而实际上并没有严格实施下去或者没有持续实施下去。最后都会甩锅给“历史包袱太重”、“开发人员太多太杂难以推广”这样的理由。<br>近半年到一年在代码规范这一块我主要思考如何在中小团队没有代码规范的基础上制定代码规范。根据自己的思考也正在组内逐步实践，从目前实践情况来看我是比较满意的，所以把自己观点写出来，希望能对跟我有同样困惑的人有些帮助。</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Code-Style/">Code Style</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/StandardJS/">StandardJS</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2017/06/06/how-to-setup-team-code-style/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Vim-for-front-end-developer" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/28/Vim-for-front-end-developer/" class="article-date">
  	<time datetime="2017-05-28T05:46:54.000Z" itemprop="datePublished">2017-05-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/28/Vim-for-front-end-developer/">Vim入门高频功能分享</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>自己用Vim也已经5年了，如果让我回忆五年前刚毕业我做得最有价值的事情是什么，那我肯定会想到一件事，我们当时部门一个老前端项目单纯用jq，我明显感觉到模块化不够清晰，然后自己从零开始学Backbone把整个项目的改造方案列出并争取到老大许可，自己重构了一遍。但是这件事对今天的影响远远小于另外一件事，那就是在那过程中我强制自己使用了半年的Vim，那个项目基本都是纯Vim写完的。也正式从那时起，我变成了传说中的Vim党，但是我非常肯定的说，我还是低端使用者。</p>
<p>最近在公司经常去帮同事解决一下一些小问题，但是每次做到同事机器面前，想敲点测试代码的时候，竟然不知所措，只因为大多同事都没在用Vim，于是为了自己以后帮人看问题方便，就希望能尽自己所能推广一下Vim，故约了几个平时关系不错但是不用Vim的同事给他们安利一波。当然网上Vim的教程是非常多，但是个人认为1000个人有一千个Vim，因为做一件事Vim可以很多种方式完成。也正因为如此，特意总结了自己使用得最频繁的一些功能，给大家做了分享，下面是分享的PPT，希望也能让更多的人用上这个”古老”的编辑器。</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vim/">Vim</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编辑器/">编辑器</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2017/05/28/Vim-for-front-end-developer/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-轻量随机JS对象生成工具-Mocker" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/23/轻量随机JS对象生成工具-Mocker/" class="article-date">
  	<time datetime="2017-05-23T11:50:43.000Z" itemprop="datePublished">2017-05-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/23/轻量随机JS对象生成工具-Mocker/">轻量JS mock对象生成工具-Mocker</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>前端开发过程中, 通常的开发流是, 前后端定义协议, 再分别开发.  然而此开发流必然存在前后端并行的阶段, 通常情况此阶段前端不得不自己手写假数据先开发界面和交互逻辑, 等到和后台联调, 再把假数据替换成真实的后台数据.  这整个过程造假数据的过程非常重复, 开发体验糟糕. 我尝试搜索解决此问题的反感, 总结下来基本是两个思路: </p>
<ol>
<li>直接生成mock的后端服务,  根据指定的协议(例如swagger)自动生成后端mocker, 例如 <a href="swaggerhub.com">swaggerhub</a></li>
<li>前端生成mock数据直接返回, 例如 <a href="https://github.com/marak/Faker.js/" target="_blank" rel="external">Facker.js</a>和<a href="http://mockjs.com/" target="_blank" rel="external">MockJS</a></li>
</ol>
<p>不过我尝试了上述两种方式以后并不是很满意.</p>
<p>第一种我遇到的问题是: 因为内网的各种限制, 我并不能很顺畅的访问到它mocker的服务, 当然, 是有一些替代的私有化部署方案, 但是算下来工作量其实也不小, 而且明显感觉一件简单的事情变得越来越复杂. </p>
<p>因为第一种方式遇到的问题, 我也更偏向于使用第二种方案, Faker.js可以说是大而全, 能满足所有需求, 但是也正是因为大而全, 我抛弃了他, 因为我理解这种Mock的需求, 虽然是开发前期的刚需, 但是频率通常不会很高, 算是低频刚需. 如果用一个大而全的, 因为API复杂, 会导致我用一次, 下次再使用的时候已经忘记了一些配置的说明, 每次用起来都要重新查, 这是比较痛苦的, 所以我希望能有一个简单一点的解决方案.</p>
<p>mock.js的API就明显简单很多, 然而我没有使用mock.js的原因是:  它需要mock的对象的key和值的格式说明放到一起, 例如, <code>stringValue|1-10</code>, 因为我需要在其他也需要公用配置, 而且我自己认为这是对Key的一种污染,  所以我更偏向于保持stringValue这个key的纯净.</p>
<p>正因为上述遇到的问题我才考虑自己实现一个更简单满足自己需求的Mock工具, 简单命名其为Mocker.</p>
<h2 id="Mocker的目标"><a href="#Mocker的目标" class="headerlink" title="Mocker的目标"></a>Mocker的目标</h2><p>上面已经说了目前一些解决方案不是很满足我自己需求, 所以我准备自己开发一个, 开发之前大概思考了一下自己的需求, 主要有下面几点: </p>
<ol>
<li>只支持前端mock数据, 使用时直接在前端模拟返回</li>
<li>足够简单, 类型不能太多, 只需要支持String, Number, Enum, Boolean. 并且几种类型上也只添加最基本的限制规则, 例如长度和格式.</li>
<li>支持Array和Object</li>
</ol>
<p>根据上述目标, 最终完成了Mocker的开发并在真实项目中使用. 具体项目地址: <a href="https://github.com/UnPourTous/mocker" target="_blank" rel="external">https://github.com/UnPourTous/mocker</a></p>
<h2 id="使用方式展示"><a href="#使用方式展示" class="headerlink" title="使用方式展示"></a>使用方式展示</h2><p>下面是我的API配置, 其中配置了path, method, 等必要信息, 以及request/response信息, 其中response的配置遵循Mocker的规范. 例如:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Mocker, Types &#125; <span class="keyword">from</span> <span class="string">'@unpourtous/mocker'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> API = &#123;</div><div class="line">  aGreatAPI: &#123;</div><div class="line">    mockable: <span class="literal">true</span>,</div><div class="line">    path: <span class="string">'greate/api/path'</span>,</div><div class="line">    method: <span class="string">'GET'</span>,</div><div class="line">    request: &#123;&#125;,</div><div class="line">    response: &#123;</div><div class="line">      stringDate: Types.string(<span class="string">'date'</span>),</div><div class="line">      stringRange: Types.string().range(<span class="number">10</span>, <span class="number">100</span>),</div><div class="line">      numberRange: Types.number().range(<span class="number">0</span>, <span class="number">100</span>),</div><div class="line">      enum: Types.enum([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>])</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在访问此请求的时候, 通过判断mockable的设置确定是否需要返回mock数据:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">APIClient</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> get (cgi, params = &#123;&#125;, headers = &#123;&#125;, option = &#123;&#125;) &#123;</div><div class="line">    <span class="keyword">if</span> (cgi.mockable === <span class="literal">true</span> &amp;&amp; cgi.response) &#123;</div><div class="line">      <span class="comment">// 生成mock数据</span></div><div class="line">      <span class="keyword">const</span> mockResponse = Mocker.mockObject(cgi.response)</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(mockResponse)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 调用</span></div><div class="line">APIClient.get(API.aGreatAPI).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// 这里就可以拿到mock数据了</span></div><div class="line">&#125;, error =&gt; &#123;</div><div class="line"></div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>可以看到上面以非常简单的结构, 就可以实现前端数据的mock, 目前String支持长度限制和正则. 数字支持范围和格式. 具体API说明可以参考 <a href="https://github.com/UnPourTous/mocker" target="_blank" rel="external">https://github.com/UnPourTous/mocker</a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Mocker因为一个低频刚需而生, 故确定他的主要特点是简单, 设计之初就希望即使允许它不能解决10%的可能场景, 也要保持简单. 所以最终API也只有10个左右, 而且非常易于理解. 当然如果您有什么建议也欢迎提PR或者联系我. </p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swagger/">Swagger</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mock/">mock</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-foosball" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/11/foosball/" class="article-date">
  	<time datetime="2017-05-11T01:27:07.000Z" itemprop="datePublished">2017-05-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/11/foosball/">桌上足球进攻防守打法经验分享</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>打桌上足球也已接近4年, 工作接近5年, 一路走来, 因为桌上足球也结识了一些朋友, 一起分析打发, 思考如何防守, 时常切磋, 回想起来也有不少快乐的时光, 也正因为如此最近组内分享轮到自己的时候决定分享自己打桌上足球的一些经验, 当然我承认自己是比较业余的, 毕竟很多职业比赛中用的打法还不会. 下面是根据这几年经验总结用于分享的PPT, 欢迎指正交流.</p>
<img src="/2017/05/11/foosball/桌上足球经验分享.002.jpeg" alt="桌上足球经验分享.002.jpeg" title="">
<img src="/2017/05/11/foosball/桌上足球经验分享.003.jpeg" alt="桌上足球经验分享.003.jpeg" title="">
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Foosball/">Foosball</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/桌上足球/">桌上足球</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2017/05/11/foosball/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Android-Things-Try-adb-error" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/31/Android-Things-Try-adb-error/" class="article-date">
  	<time datetime="2016-12-31T12:24:54.000Z" itemprop="datePublished">2016-12-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/31/Android-Things-Try-adb-error/">Android Things 尝鲜及免坑指南</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <img src="/2016/12/31/Android-Things-Try-adb-error/raspberry-pi-3-android-things.jpg" alt="raspberry-pi-3-android-things.jpg" title="">
<p>作为对物联网充满期待的Android开发人员, Google出了Android Things 这个IoT 的系统自然是激动的, 所以第一时间搞了一个树莓派来尝试一下, 正好可以把之前玩Arduino 时买的一些传感器再玩玩. 本篇主要记录一下Android Things 的烧入和整个过程中的一些坑的提醒, 希望能帮看文章的你绕过他们. </p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AndroidThings/">AndroidThings</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IoT/">IoT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树莓派/">树莓派</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/12/31/Android-Things-Try-adb-error/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-angular-infdig-Infinite-digest-loop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/12/angular-infdig-Infinite-digest-loop/" class="article-date">
  	<time datetime="2016-11-11T17:37:43.000Z" itemprop="datePublished">2016-11-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/12/angular-infdig-Infinite-digest-loop/">AngularJS 无限Digest循环导致的错误(infdig)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近在开发Angular项目过程中遇到一个问题, 日期相关, 核心错误点在于我把一个日期对象挂到$scope 上, view 里面两个地方分别用到了当天和后一天, 大概的示例代码如下: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// test.ctrl.js</span></div><div class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'ericTestApp'</span>, [<span class="string">'ngRoute'</span>]).config([<span class="string">'$routeProvider'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$routeProvider</span>) </span>&#123;</div><div class="line">  $routeProvider.when(<span class="string">'/bad'</span>, &#123;</div><div class="line">    controller: <span class="string">'BadCtrl'</span>, </div><div class="line">    template: <span class="string">'&lt;div&gt;today: &#123;&#123;today | date :"yyyy-MM-dd HH:mm:ss"&#125;&#125;&lt;/div&gt;&lt;div&gt;today: &#123;&#123;tomorrow() | date :"yyyy-MM-dd HH:mm:ss"&#125;&#125;&lt;/div&gt;'</span></div><div class="line">  &#125;).otherwise(&#123;</div><div class="line">    redirectTo: <span class="string">'/bad'</span></div><div class="line">  &#125;);</div><div class="line">&#125;]);</div><div class="line"></div><div class="line">app.controller(<span class="string">'BadCtrl'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</div><div class="line">  $scope.today = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">  $scope.tomorrow = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'tomorrow called '</span> + $scope.today);</div><div class="line">    <span class="keyword">var</span> tmr = $scope.today;</div><div class="line">    tmr = tmr.setDate(tmr.getDate() + <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> tmr;</div><div class="line">  &#125;;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>上面的代码运行起来会抛出 <code>Error: $rootScope:infdig
Infinite $digest Loop</code> 的错误信息, 这问题涉及到两个点, 一是对象引用;  二是Angular 的$digest 循环和它的脏值检测. </p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Angular/">Angular</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/11/12/angular-infdig-Infinite-digest-loop/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-nginx-Reverse-Proxy" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/09/nginx-Reverse-Proxy/" class="article-date">
  	<time datetime="2016-11-09T14:52:08.000Z" itemprop="datePublished">2016-11-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/09/nginx-Reverse-Proxy/">配置NGINX反向代理到Node Server</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>平时工作中偶尔需要在服务器上放个NodeJS的Server, 但是每次都迫于80端口被占用只能转而使用3000, 4000等其他端口, 今天决定整理一下这一块, 放一个Nginx在前面, 由它来转发, 这样就可以实现80端口的共用, 如此则可应对一些只能支持80端口的场景, 例如微信公众帐号的开发, 目前微信小程序出来以后众多人追捧, 其中小程序有一条限制, 就是能访问的域名不能超过三个, 通过类似的设置, 用一台服务器做一下转发, 也可以破解此限制.</p>
<h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>目标很简单, 就是要实现下面的这个简单得不能再简单的架构.<br><img src="/2016/11/09/nginx-Reverse-Proxy/reverse-proxy.png" alt="reverse-proxy.png" title=""></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Deploy/">Deploy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NGINX/">NGINX</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node/">Node</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/11/09/nginx-Reverse-Proxy/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-what-to-do-befor-release-app" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/20/what-to-do-befor-release-app/" class="article-date">
  	<time datetime="2015-09-20T09:43:31.000Z" itemprop="datePublished">2015-09-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/20/what-to-do-befor-release-app/">App发布上线时候容易被忽略的准备工作</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前段时间公司发布了App, 虽然没有直接参与发布, 但是在发布后看到了一些问题, 根据自己当时观察到的一些混乱情况, 大概梳理了一些App上线前容易被忽略掉的准备工作. </p>
<h2 id="准备介绍的文案"><a href="#准备介绍的文案" class="headerlink" title="准备介绍的文案"></a>准备介绍的文案</h2><p>记得当时有一个比较乌龙的事件, App发布以后公司同事们都很积极的推广, 由于没有官方的介绍文章, 有同事开始转发外面某人写的一篇介绍文章, 当朋友圈被刷屏的时候, 我点开文章认真读完, 发现里面有不少内容竟是吐槽的, 如此文章被内部人员大量转发, 实在太尴尬. 究其原因: </p>
<ol>
<li><p>没有官方介绍文章. </p>
</li>
<li><p>大家宣传热情高 &amp;&amp; 长期养成的看标题直接转发的习惯. </p>
</li>
</ol>
<p>第二点可能不是App发布者可以控制的, 而第一点就非常值得重视, 准备一篇官方介绍文章即可以避免此类乌龙事件, 也可以在宣传产品的同时为自己的公共帐号拉粉丝, 为以后产品宣传铺路. </p>
<h2 id="根据目标用户定义合适的社交平台做宣传"><a href="#根据目标用户定义合适的社交平台做宣传" class="headerlink" title="根据目标用户定义合适的社交平台做宣传"></a>根据目标用户定义合适的社交平台做宣传</h2><p>同样是那次发布, 当时App发布以后, 朋友圈被刷屏刷爆, 但是自己刷了一下微博, 也搜索了一下, 竟然没有相关新闻和消息. 自认为这也是一个相对容易被忽略的问题, 在看到朋友圈的相关内容非常多的时候觉得宣传很给力了, 但是实际上是因为圈子问题, 一个公司的人大多圈子比较相近.<br>故在宣传时候需要根据根据自己的目标用户定义好需要投入宣传资源的平台, 并做好宣传规划. </p>
<h2 id="准备更好用的二维码"><a href="#准备更好用的二维码" class="headerlink" title="准备更好用的二维码"></a>准备更好用的二维码</h2><p>现在发布App通常都通过二维码下载, 当时我们遇到的更二维码相关的问题主要有两个: </p>
<ol>
<li>使用了两个二维码, Android和iOS的二维码不容易区分</li>
<li>有新版以后出现多个二维码, 系统一维, 版本一维, 出现了非常多的二维码, 更加难以选择且容易错误下到旧版本App.</li>
</ol>
<p>当时我就发了一条朋友圈提到两个平台分别要区分扫不同的二维码不是好的体验, 这是程序可以判断的, 不应该丢给用户去判断. 后来运营的同学确实改用了平台通用的二维码. </p>
<p>那还剩下一个版本更新问题, 我们都知道二维码生成以后对应固定的链接, 如果直接是吧文件下载url做成二维码, 那升级版本以后二维码必然要生成新的. 针这个点我认为更好的方式是二维码指向一个中间页面, 中间页面根据User-Agent跳转不同平台, 因为中间页面的引入, 也可以做到动态的替换实际的下载链接, 如此可以解决上面遇到的两个问题, 增加了灵活性, 如果要添加下载统计也更方便. </p>
<h2 id="定义清晰的反馈流程"><a href="#定义清晰的反馈流程" class="headerlink" title="定义清晰的反馈流程"></a>定义清晰的反馈流程</h2><p>这个可能大部分人都会注意到, 当时看到的问题是: 公司内的反馈都通过IM工具在群里反馈, 出现非常多重复反馈, 导致运营人员大量的解答重复的问题, 另外有的人找开发反馈, 有的人找产品或者运营人员反馈, 也导致了不少的混乱和人力的浪费. 针对这些问题自己觉得如下几个措施可能改善这些问题. </p>
<ol>
<li>分别建立内部和外部反馈群, 分人负责, 遇到反馈的人都拉进群统一反馈. </li>
<li>定期整理汇总反馈频度高的问题和解决方案或统一答复为文档, 供被重复反馈时使用(策略允许也可以发布到一些论坛)</li>
<li>大招: 尽快修复反馈非常多的问题.</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 EricHua23
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-19006243-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>