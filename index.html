<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>23Lab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="23Lab">
<meta property="og:url" content="http://blog.23lab.com/index.html">
<meta property="og:site_name" content="23Lab">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="23Lab">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="23Lab" type="application/atom+xml">
  
  
    <link rel="icon" href="http://blog.23lab.com/images/avatar.jpg">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://blog.23lab.com/images/avatar.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">EricHua23</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/tools">工具</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/erichua23" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/javoft" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/AndroidThings/" style="font-size: 10px;">AndroidThings</a> <a href="/tags/Angular/" style="font-size: 10px;">Angular</a> <a href="/tags/Deploy/" style="font-size: 10px;">Deploy</a> <a href="/tags/Foosball/" style="font-size: 10px;">Foosball</a> <a href="/tags/IoT/" style="font-size: 10px;">IoT</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/NGINX/" style="font-size: 10px;">NGINX</a> <a href="/tags/Node/" style="font-size: 10px;">Node</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/Swagger/" style="font-size: 10px;">Swagger</a> <a href="/tags/Unit-Test/" style="font-size: 10px;">Unit Test</a> <a href="/tags/Vim/" style="font-size: 10px;">Vim</a> <a href="/tags/Zend-Framework/" style="font-size: 10px;">Zend Framework</a> <a href="/tags/mock/" style="font-size: 10px;">mock</a> <a href="/tags/南京/" style="font-size: 20px;">南京</a> <a href="/tags/南京大学/" style="font-size: 10px;">南京大学</a> <a href="/tags/实习/" style="font-size: 10px;">实习</a> <a href="/tags/杭州/" style="font-size: 10px;">杭州</a> <a href="/tags/树莓派/" style="font-size: 10px;">树莓派</a> <a href="/tags/桌上足球/" style="font-size: 10px;">桌上足球</a> <a href="/tags/淘宝/" style="font-size: 10px;">淘宝</a> <a href="/tags/编辑器/" style="font-size: 10px;">编辑器</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">现在微众银行主要负责微众银行App开发, 工作范围在于React Native，Web前端，Android&amp;iOS开发, 同时对各种非工作范围的技术和工具也有浓烈的兴趣.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">EricHua23</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://blog.23lab.com/images/avatar.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">EricHua23</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/tools">工具</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/erichua23" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/javoft" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-Vim-for-front-end-developer" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/28/Vim-for-front-end-developer/" class="article-date">
  	<time datetime="2017-05-28T05:46:54.000Z" itemprop="datePublished">2017-05-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/28/Vim-for-front-end-developer/">Vim入门高频功能分享</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>自己用Vim也已经5年了，如果让我回忆五年前刚毕业我做得最有价值的事情是什么，那我肯定会想到一件事，我们当时部门一个老前端项目单纯用jq，我明显感觉到模块化不够清晰，然后自己从零开始学Backbone把整个项目的改造方案列出并争取到老大许可，自己重构了一遍。但是这件事对今天的影响远远小于另外一件事，那就是在那过程中我强制自己使用了半年的Vim，那个项目基本都是纯Vim写完的。也正式从那时起，我变成了传说中的Vim党，但是我非常肯定的说，我还是低端使用者。</p>
<p>最近在公司经常去帮同事解决一下一些小问题，但是每次做到同事机器面前，想敲点测试代码的时候，竟然不知所措，只因为大多同事都没在用Vim，于是为了自己以后帮人看问题方便，就希望能尽自己所能推广一下Vim，故约了几个平时关系不错但是不用Vim的同事给他们安利一波。当然网上Vim的教程是非常多，但是个人认为1000个人有一千个Vim，因为做一件事Vim可以很多种方式完成。也正因为如此，特意总结了自己使用得最频繁的一些功能，给大家做了分享，下面是分享的PPT，希望也能让更多的人用上这个”古老”的编辑器。</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vim/">Vim</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编辑器/">编辑器</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2017/05/28/Vim-for-front-end-developer/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-轻量随机JS对象生成工具-Mocker" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/23/轻量随机JS对象生成工具-Mocker/" class="article-date">
  	<time datetime="2017-05-23T11:50:43.000Z" itemprop="datePublished">2017-05-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/23/轻量随机JS对象生成工具-Mocker/">轻量JS mock对象生成工具-Mocker</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="背景">背景</h2><p>前端开发过程中, 通常的开发流是, 前后端定义协议, 再分别开发.  然而此开发流必然存在前后端并行的阶段, 通常情况此阶段前端不得不自己手写假数据先开发界面和交互逻辑, 等到和后台联调, 再把假数据替换成真实的后台数据.  这整个过程造假数据的过程非常重复, 开发体验糟糕. 我尝试搜索解决此问题的反感, 总结下来基本是两个思路: </p>
<ol>
<li>直接生成mock的后端服务,  根据指定的协议(例如swagger)自动生成后端mocker, 例如 <a href="swaggerhub.com">swaggerhub</a></li>
<li>前端生成mock数据直接返回, 例如 <a href="https://github.com/marak/Faker.js/" target="_blank" rel="external">Facker.js</a>和<a href="http://mockjs.com/" target="_blank" rel="external">MockJS</a></li>
</ol>
<p>不过我尝试了上述两种方式以后并不是很满意.</p>
<p>第一种我遇到的问题是: 因为内网的各种限制, 我并不能很顺畅的访问到它mocker的服务, 当然, 是有一些替代的私有化部署方案, 但是算下来工作量其实也不小, 而且明显感觉一件简单的事情变得越来越复杂. </p>
<p>因为第一种方式遇到的问题, 我也更偏向于使用第二种方案, Faker.js可以说是大而全, 能满足所有需求, 但是也正是因为大而全, 我抛弃了他, 因为我理解这种Mock的需求, 虽然是开发前期的刚需, 但是频率通常不会很高, 算是低频刚需. 如果用一个大而全的, 因为API复杂, 会导致我用一次, 下次再使用的时候已经忘记了一些配置的说明, 每次用起来都要重新查, 这是比较痛苦的, 所以我希望能有一个简单一点的解决方案.</p>
<p>mock.js的API就明显简单很多, 然而我没有使用mock.js的原因是:  它需要mock的对象的key和值的格式说明放到一起, 例如, <code>stringValue|1-10</code>, 因为我需要在其他也需要公用配置, 而且我自己认为这是对Key的一种污染,  所以我更偏向于保持stringValue这个key的纯净.</p>
<p>正因为上述遇到的问题我才考虑自己实现一个更简单满足自己需求的Mock工具, 简单命名其为Mocker.</p>
<h2 id="Mocker的目标">Mocker的目标</h2><p>上面已经说了目前一些解决方案不是很满足我自己需求, 所以我准备自己开发一个, 开发之前大概思考了一下自己的需求, 主要有下面几点: </p>
<ol>
<li>只支持前端mock数据, 使用时直接在前端模拟返回</li>
<li>足够简单, 类型不能太多, 只需要支持String, Number, Enum, Boolean. 并且几种类型上也只添加最基本的限制规则, 例如长度和格式.</li>
<li>支持Array和Object</li>
</ol>
<p>根据上述目标, 最终完成了Mocker的开发并在真实项目中使用. 具体项目地址: <a href="https://github.com/UnPourTous/mocker" target="_blank" rel="external">https://github.com/UnPourTous/mocker</a></p>
<h2 id="使用方式展示">使用方式展示</h2><p>下面是我的API配置, 其中配置了path, method, 等必要信息, 以及request/response信息, 其中response的配置遵循Mocker的规范. 例如:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Mocker, Types &#125; <span class="keyword">from</span> <span class="string">'@unpourtous/mocker'</span></span><br><span class="line"></span><br><span class="line">const API = &#123;</span><br><span class="line">  aGreatAPI: &#123;</span><br><span class="line">    mockable: true,</span><br><span class="line">    path: <span class="string">'greate/api/path'</span>,</span><br><span class="line">    method: <span class="string">'GET'</span>,</span><br><span class="line">    request: &#123;&#125;,</span><br><span class="line">    response: &#123;</span><br><span class="line">      stringDate: Types.string(<span class="string">'date'</span>),</span><br><span class="line">      stringRange: Types.string().range(10, 100),</span><br><span class="line">      numberRange: Types.number().range(0, 100),</span><br><span class="line">      enum: Types.enum([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在访问此请求的时候, 通过判断mockable的设置确定是否需要返回mock数据:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">APIClient</span> </span>&#123;</span><br><span class="line">  static get (cgi, params = &#123;&#125;, headers = &#123;&#125;, option = &#123;&#125;) &#123;</span><br><span class="line">    <span class="keyword">if</span> (cgi.mockable === <span class="literal">true</span> &amp;&amp; cgi.response) &#123;</span><br><span class="line">      <span class="comment">// 生成mock数据</span></span><br><span class="line">      <span class="keyword">const</span> mockResponse = Mocker.mockObject(cgi.response)</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(mockResponse)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line">APIClient.get(API.aGreatAPI).then(response =&gt; &#123;</span><br><span class="line">  <span class="comment">// 这里就可以拿到mock数据了</span></span><br><span class="line">&#125;, error =&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>可以看到上面以非常简单的结构, 就可以实现前端数据的mock, 目前String支持长度限制和正则. 数字支持范围和格式. 具体API说明可以参考 <a href="https://github.com/UnPourTous/mocker" target="_blank" rel="external">https://github.com/UnPourTous/mocker</a></p>
<h2 id="总结">总结</h2><p>Mocker因为一个低频刚需而生, 故确定他的主要特点是简单, 设计之初就希望即使允许它不能解决10%的可能场景, 也要保持简单. 所以最终API也只有10个左右, 而且非常易于理解. 当然如果您有什么建议也欢迎提PR或者联系我. </p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swagger/">Swagger</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mock/">mock</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-foosball" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/05/11/foosball/" class="article-date">
  	<time datetime="2017-05-11T01:27:07.000Z" itemprop="datePublished">2017-05-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/05/11/foosball/">桌上足球进攻防守打法经验分享</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>打桌上足球也已接近4年, 工作接近5年, 一路走来, 因为桌上足球也结识了一些朋友, 一起分析打发, 思考如何防守, 时常切磋, 回想起来也有不少快乐的时光, 也正因为如此最近组内分享轮到自己的时候决定分享自己打桌上足球的一些经验, 当然我承认自己是比较业余的, 毕竟很多职业比赛中用的打法还不会. 下面是根据这几年经验总结用于分享的PPT, 欢迎指正交流. </p>
<img src="/2017/05/11/foosball/桌上足球经验分享.002.jpeg" alt="桌上足球经验分享.002.jpeg" title="">
<img src="/2017/05/11/foosball/桌上足球经验分享.003.jpeg" alt="桌上足球经验分享.003.jpeg" title="">
<img src="/2017/05/11/foosball/桌上足球经验分享.004.jpeg" alt="桌上足球经验分享.004.jpeg" title="">
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Foosball/">Foosball</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/桌上足球/">桌上足球</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2017/05/11/foosball/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Android-Things-Try-adb-error" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/31/Android-Things-Try-adb-error/" class="article-date">
  	<time datetime="2016-12-31T12:24:54.000Z" itemprop="datePublished">2016-12-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/31/Android-Things-Try-adb-error/">Android Things 尝鲜及免坑指南</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <img src="/2016/12/31/Android-Things-Try-adb-error/raspberry-pi-3-android-things.jpg" alt="raspberry-pi-3-android-things.jpg" title="">
<p>作为对物联网充满期待的Android开发人员, Google出了Android Things 这个IoT 的系统自然是激动的, 所以第一时间搞了一个树莓派来尝试一下, 正好可以把之前玩Arduino 时买的一些传感器再玩玩. 本篇主要记录一下Android Things 的烧入和整个过程中的一些坑的提醒, 希望能帮看文章的你绕过他们. </p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AndroidThings/">AndroidThings</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IoT/">IoT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树莓派/">树莓派</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/12/31/Android-Things-Try-adb-error/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-angular-infdig-Infinite-digest-loop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/12/angular-infdig-Infinite-digest-loop/" class="article-date">
  	<time datetime="2016-11-11T17:37:43.000Z" itemprop="datePublished">2016-11-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/12/angular-infdig-Infinite-digest-loop/">AngularJS 无限Digest循环导致的错误(infdig)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近在开发Angular项目过程中遇到一个问题, 日期相关, 核心错误点在于我把一个日期对象挂到$scope 上, view 里面两个地方分别用到了当天和后一天, 大概的示例代码如下: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.ctrl.js</span></span><br><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'ericTestApp'</span>, [<span class="string">'ngRoute'</span>]).config([<span class="string">'$routeProvider'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$routeProvider</span>) </span>&#123;</span><br><span class="line">  $routeProvider.when(<span class="string">'/bad'</span>, &#123;</span><br><span class="line">    controller: <span class="string">'BadCtrl'</span>, </span><br><span class="line">    template: <span class="string">'&lt;div&gt;today: &#123;&#123;today | date :"yyyy-MM-dd HH:mm:ss"&#125;&#125;&lt;/div&gt;&lt;div&gt;today: &#123;&#123;tomorrow() | date :"yyyy-MM-dd HH:mm:ss"&#125;&#125;&lt;/div&gt;'</span></span><br><span class="line">  &#125;).otherwise(&#123;</span><br><span class="line">    redirectTo: <span class="string">'/bad'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;]);</span><br><span class="line"></span><br><span class="line">app.controller(<span class="string">'BadCtrl'</span>, [<span class="string">'$scope'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</span><br><span class="line">  $scope.today = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  $scope.tomorrow = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'tomorrow called '</span> + $scope.today);</span><br><span class="line">    <span class="keyword">var</span> tmr = $scope.today;</span><br><span class="line">    tmr = tmr.setDate(tmr.getDate() + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> tmr;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure>
<p>上面的代码运行起来会抛出 <code>Error: $rootScope:infdig
Infinite $digest Loop</code> 的错误信息, 这问题涉及到两个点, 一是对象引用;  二是Angular 的$digest 循环和它的脏值检测. </p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Angular/">Angular</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/11/12/angular-infdig-Infinite-digest-loop/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-nginx-Reverse-Proxy" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/09/nginx-Reverse-Proxy/" class="article-date">
  	<time datetime="2016-11-09T14:52:08.000Z" itemprop="datePublished">2016-11-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/09/nginx-Reverse-Proxy/">配置NGINX反向代理到Node Server</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="背景">背景</h2><p>平时工作中偶尔需要在服务器上放个NodeJS的Server, 但是每次都迫于80端口被占用只能转而使用3000, 4000等其他端口, 今天决定整理一下这一块, 放一个Nginx在前面, 由它来转发, 这样就可以实现80端口的共用, 如此则可应对一些只能支持80端口的场景, 例如微信公众帐号的开发, 目前微信小程序出来以后众多人追捧, 其中小程序有一条限制, 就是能访问的域名不能超过三个, 通过类似的设置, 用一台服务器做一下转发, 也可以破解此限制.</p>
<h2 id="目标">目标</h2><p>目标很简单, 就是要实现下面的这个简单得不能再简单的架构.<br><img src="/2016/11/09/nginx-Reverse-Proxy/reverse-proxy.png" alt="reverse-proxy.png" title=""></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Deploy/">Deploy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NGINX/">NGINX</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node/">Node</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2016/11/09/nginx-Reverse-Proxy/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-what-to-do-befor-release-app" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/20/what-to-do-befor-release-app/" class="article-date">
  	<time datetime="2015-09-20T09:43:31.000Z" itemprop="datePublished">2015-09-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/20/what-to-do-befor-release-app/">App发布上线时候容易被忽略的准备工作</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前段时间公司发布了App, 虽然没有直接参与发布, 但是在发布后看到了一些问题, 根据自己当时观察到的一些混乱情况, 大概梳理了一些App上线前容易被忽略掉的准备工作. </p>
<h2 id="准备介绍的文案">准备介绍的文案</h2><p>记得当时有一个比较乌龙的事件, App发布以后公司同事们都很积极的推广, 由于没有官方的介绍文章, 有同事开始转发外面某人写的一篇介绍文章, 当朋友圈被刷屏的时候, 我点开文章认真读完, 发现里面有不少内容竟是吐槽的, 如此文章被内部人员大量转发, 实在太尴尬. 究其原因: </p>
<ol>
<li><p>没有官方介绍文章. </p>
</li>
<li><p>大家宣传热情高 &amp;&amp; 长期养成的看标题直接转发的习惯. </p>
</li>
</ol>
<p>第二点可能不是App发布者可以控制的, 而第一点就非常值得重视, 准备一篇官方介绍文章即可以避免此类乌龙事件, 也可以在宣传产品的同时为自己的公共帐号拉粉丝, 为以后产品宣传铺路. </p>
<h2 id="根据目标用户定义合适的社交平台做宣传">根据目标用户定义合适的社交平台做宣传</h2><p>同样是那次发布, 当时App发布以后, 朋友圈被刷屏刷爆, 但是自己刷了一下微博, 也搜索了一下, 竟然没有相关新闻和消息. 自认为这也是一个相对容易被忽略的问题, 在看到朋友圈的相关内容非常多的时候觉得宣传很给力了, 但是实际上是因为圈子问题, 一个公司的人大多圈子比较相近.<br>故在宣传时候需要根据根据自己的目标用户定义好需要投入宣传资源的平台, 并做好宣传规划. </p>
<h2 id="准备更好用的二维码">准备更好用的二维码</h2><p>现在发布App通常都通过二维码下载, 当时我们遇到的更二维码相关的问题主要有两个: </p>
<ol>
<li>使用了两个二维码, Android和iOS的二维码不容易区分</li>
<li>有新版以后出现多个二维码, 系统一维, 版本一维, 出现了非常多的二维码, 更加难以选择且容易错误下到旧版本App.</li>
</ol>
<p>当时我就发了一条朋友圈提到两个平台分别要区分扫不同的二维码不是好的体验, 这是程序可以判断的, 不应该丢给用户去判断. 后来运营的同学确实改用了平台通用的二维码. </p>
<p>那还剩下一个版本更新问题, 我们都知道二维码生成以后对应固定的链接, 如果直接是吧文件下载url做成二维码, 那升级版本以后二维码必然要生成新的. 针这个点我认为更好的方式是二维码指向一个中间页面, 中间页面根据User-Agent跳转不同平台, 因为中间页面的引入, 也可以做到动态的替换实际的下载链接, 如此可以解决上面遇到的两个问题, 增加了灵活性, 如果要添加下载统计也更方便. </p>
<h2 id="定义清晰的反馈流程">定义清晰的反馈流程</h2><p>这个可能大部分人都会注意到, 当时看到的问题是: 公司内的反馈都通过IM工具在群里反馈, 出现非常多重复反馈, 导致运营人员大量的解答重复的问题, 另外有的人找开发反馈, 有的人找产品或者运营人员反馈, 也导致了不少的混乱和人力的浪费. 针对这些问题自己觉得如下几个措施可能改善这些问题. </p>
<ol>
<li>分别建立内部和外部反馈群, 分人负责, 遇到反馈的人都拉进群统一反馈. </li>
<li>定期整理汇总反馈频度高的问题和解决方案或统一答复为文档, 供被重复反馈时使用(策略允许也可以发布到一些论坛)</li>
<li>大招: 尽快修复反馈非常多的问题.</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ImageView-scaleType" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/20/ImageView-scaleType/" class="article-date">
  	<time datetime="2015-09-19T17:56:50.000Z" itemprop="datePublished">2015-09-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/20/ImageView-scaleType/">ImageView的scaleType介绍</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>使用ImageView的时候难以避免的就要去确定图片缩放的方式也就是scaleType, 之前多次使用ImageView的时候需要设置scaleType, 今天再次用到还是记不清几种scaleType的区别, 这里整理一下方便自己加深印象. </p>
<p>ImageView的scaleType有如下几类: </p>
<img src="/2015/09/20/ImageView-scaleType/all_types.png" alt="[ImageViewScaleType]" title="[ImageViewScaleType]">
<p>下面我们分别来尝试并理解上面的各种ScaleType, 主要分为三种情况来实验, View的长宽分别小于Image的长宽以及View的长宽都大于Image的长宽. </p>
<img src="/2015/09/20/ImageView-scaleType/scaleTypeCompare.jpg" alt="[ScaleTypeCompare]" title="[ScaleTypeCompare]">
<p>测试代码见:<br><a href="https://github.com/erichua23/Demos/tree/master/ImageViewScaleType" target="_blank" rel="external">https://github.com/erichua23/Demos/tree/master/ImageViewScaleType</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-how-to-design-better-sdk-interface" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/07/05/how-to-design-better-sdk-interface/" class="article-date">
  	<time datetime="2014-07-05T11:27:00.000Z" itemprop="datePublished">2014-07-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/05/how-to-design-better-sdk-interface/">SDK开发过程的一些问题总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>过去的一年多时间里都在做SDK, 这一年从Web开发转到Android开发也算是成功的转型了, 被坑了很多次, 也坑了很多人很多次, 在各种互坑的过程中学到了些东西. 写在这里也算是对过去一年坑别人的一次反省(阿弥陀佛~~). </p>
<p>SDK有一个很大的特点, 它的用户是程序猿(这是我大学时代梦寐以求的呢); 而App的用户则通常是普通用户. 我们知道, 有的程序猿很懒, 有的程序猿又喜欢追求完美, 简单来说吧, 就是程序猿太tm难伺候了. 这就直接导致了SDK开发的一些特殊性. 下面简单谈谈过去在项目中遇到的觉得应该注意的一些点, 大部分可能不只是SDK开发才会遇到的, 即使是App开发, 如果你写出来的接口别人用起来比较爽, 那也是不错的事呢.</p>
<p>我们的SDK是给游戏用的, 所以后面我会习惯性称SDK的使用者为游戏. 另外说明一点是我们的SDK封装了很多其他外部SDK. </p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Andoird/">Andoird</a><a class="article-category-link" href="/categories/Andoird/SDK/">SDK</a><a class="article-category-link" href="/categories/Andoird/SDK/API设计/">API设计</a><a class="article-category-link" href="/categories/Andoird/SDK/API设计/SDK设计/">SDK设计</a>
	</div>


      
        <p class="article-more-link">
          <a  href="/2014/07/05/how-to-design-better-sdk-interface/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-something-about-android-signature" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/06/21/something-about-android-signature/" class="article-date">
  	<time datetime="2014-06-21T08:02:00.000Z" itemprop="datePublished">2014-06-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/21/something-about-android-signature/">Android签名(Signature)漫谈(一)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在工作过程中接触到很多Android开发, 当然大部分是游戏开发, 我发现好像很多人都不是特别理解Android签名到底是什么一回事, 甚至别人问自己的时候, 自己要解释也不能很容易的解释清楚, 于是想到了深入理解一下并将其记录下来. </p>
<p>首先我们来看一下Android整个打包过程, 再从打包过程中看一下签名是在那个阶段? 然后再去看为什么要签名以及如何签名等等问题. 借用官网一张图:<br><img src="http://developer.android.com/images/build.png" alt="general process for a typical build"></p>
<p>其中有一个步骤是Jarsigner, 它的输出结果是 signed.apk, 由此可见它应该是签名的过程, jarsigner右边的一项是Debug or Release Keystore, 说明签名可以分为debug和release的. 这是我们看到图的一个猜想, 下面看文档里面怎么说. </p>
<blockquote>
<p>Once the .apk is built, it <em>must</em> be signed with either a debug or release key before it can be installed to a device.</p>
<p>Finally, if the application is being signed in release mode, you must align the .apk with the zipalign tool. Aligning the final .apk decreases memory usage when the application is running on a device.</p>
</blockquote>
<p>注意, 文档中提到 “must be signed with a debug or release key”, 这里可能有人会问两个问题: 1. 我不签名会怎么样? 2. 我 ADT 开发Android 项目的时候我没做过签名这一步也没出什么问题呀? </p>
<h3 id="不签名会怎么样?">不签名会怎么样?</h3><p>针对上面两个问题我们分别来看, 首先第一个问题, 我们尝试去安装一个未签名的应用到 Android 设备上. 在 Eclipse 中找一个项目, 右键=&gt;Android Tools=&gt;Export Unsigned Application Package, 确定导出以后, ADT 弹出如下提示:<br><img src="https://cloud.githubusercontent.com/assets/1309744/3347860/23242e52-f8ff-11e3-8848-e763de6a4146.png" alt="image"></p>
<p>关注一下, 它再次提示我们发布前要签名, 还需要用zipalign优化, 但是我们偏要试一下用一个未签名的包会怎么样. 继续尝试安装刚刚打出来的未签名的包, 结果安装失败.<br><img src="https://cloud.githubusercontent.com/assets/1309744/3347867/d9699d0a-f8ff-11e3-87f4-c5b3505f328d.png" alt="image"></p>
<p><code>INSTALL_PARSE_FAILED_NO_CERTIFICATES</code> 因为没有证书解析失败从而安装失败, 这就说明了Android 系统本身是不接受没有签名的包的. 此时我们再去翻翻官方文档, 找到<a href="http://developer.android.com/tools/publishing/app-signing.html" target="_blank" rel="external">Signing Your Applications</a>, 其中提到: </p>
<blockquote>
<p>The Android system requires that all installed applications be digitally signed with a certificate whose private key is held by the application’s developer.</p>
</blockquote>
<p><code>signed with a certificate whose private key is held by the application&#39;s developer</code> 这里明确说明了证书是开发者的, 是用开发者的一个证书去给开发者的应用签名, 至此我们可以这样理解, 一个可运行apk文件的package name 用于标识应用, 而签名这个应用的证书则唯一的标识了应用的开发者. 系统只信任确定归属关系的应用. </p>
<blockquote>
<p>Android system uses the certificate as a means of identifying the author of an application and establishing trust relationships between applications.</p>
</blockquote>
<p>这一句中两个关键点, 一个是用于辨认开发者, 另外一个就是建立应用间的信任关系, 这个主要是用于自定义权限的, 有兴趣的可以直接查看<a href="http://developer.android.com/training/articles/security-tips.html#Permissions" target="_blank" rel="external">Using Permissions</a>. </p>
<p>到现在我们刚刚的第一个疑问已经解决: Android 系统不允许安装未签名的应用, 因为未签名也就意味着这个应用没有明确的标明开发者是谁, 只有通过在 apk 上签名, 申明了apk 是你的, 系统才会让他运行. </p>
<h3 id="ADT_开发Android项目的时候没做过签名为什么不出问题?">ADT 开发Android项目的时候没做过签名为什么不出问题?</h3><p>第一个问题清楚以后第二个问题也有眉目了, 既然ADT build 出来的包是可以安装的, 根据第一个问题的结论, 说明ADT 里面肯定有签名的过程. 回想一下上面Apk 构建过程的图, jarsigner 接收的是debug 或者 release 的keystore. 实际上ADT 是使用了默认的debug keystore, 在 ADT 中打开Preferences =&gt; Android =&gt; Build 则可见到ADT 中debug keystore 的配置.<br><img src="https://cloud.githubusercontent.com/assets/1309744/3347911/fb7f5c64-f903-11e3-9ca1-3206a0cd895a.png" alt="image"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Android/">Android</a><a class="article-category-link" href="/categories/Android/CodeSignature/">CodeSignature</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 EricHua23
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-19006243-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>